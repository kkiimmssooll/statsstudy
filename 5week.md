# ch4. 회귀와 예측

## 4.1 단순선형회귀
> 두 변수의 관계를 나타냄
> 상관관계가 변수 간 관련 강도를 측정 <-> 회귀는 **관계 자체를 정량화**
![study_1](/stats_study/4.1.png)
- 회귀선 : 잔차제곱합(RSS)을 최소화하는 선
    - 이러한 과정을 OLS 회귀라고 함

💡 회귀분석은 새로운 데이터에 대한 개별 결과를 예측하는 모델을 구성할 때 사용됨

## 4.2 다중선형회귀
![study_2](/stats_study/4.2.png)
> 직선의 형태는 아니지만 계수와 변수들의 관계는 여전히 선형(계수 베타에 대해 선형)

- RMSE(제곱근평균제곱오차) : 평균제곱오차의 제곱근
    - 값이 작을수록 예측이 정확
    - 파이썬에서는 mean_squared_error를 구해서 제곱을 취함
- RSE(잔차 표준오차) : 평균제곱오차와 동일하지만 자유도에 따라 보정된 값
- R^2(결정계수)
    - 0~1의 값으로 모델 데이터의 변동률 측정
    - 모델이 데이터를 얼마나 잘 설명하는지를 확인
    - 값이 클수록 설명력이 좋음(변수가 많아지면 무조건 커질 수 있음에 유의)

### 교차 타당성 검사
> 데이터의 일부를 떼어놓고(홀드아웃) 모델을 만든 후에 떼어놓았던 데이터를 모델에 적용->성능 확인

### AIC : 모델에 항을 추가할수록 불이익을 줌(복잡한 모델<단순한 모델)
- 모델의 적합도와 복잡도를 고려
    - 두 요소를 합쳐서 최적의 모델을 찾는 데 도움을 줌
- 모델이 복잡해질수록 벌점이 커지도록 설계된 지표
    - 최소화하는 것이 필요
```
어떻게 최소로 만들 수 있을까?
1. 후진제거(전체 모델에서 시작해서 의미없는 변수를 연속적으로 삭제)
2. 전진선택(상수 모델에서 시작해서 연속적으로 변수를 추가)
3. 벌점회귀 
```

## 4.3 회귀를 이용한 예측
- 외삽법
    - 모델링에 사용된 데이터 범위를 벗어난 부분까지 모델을 확장하는 것
    - 회귀모형은 충분한 데이터 값이 있는 예측변수에 대해서만 유효함
- 예측구간과 신뢰구간
    - 예측구간 : 하나의 값에 대한 불확실성과 관련
    - 신뢰구간 : 여러 값에서 계산된 평균이나 다른 통계량과 관련

## 4.4 회귀에서의 요인변수
> 변수를 이진 가변수(0,1)들의 집합으로 변환
```python
pd.get_dummies(house['PropertyType'], drop_first=True) ) # 범주형 변수 PropertyType의 원핫인코딩 반환/P-1개의 열을 반환하여 다중공선성 문제를 피함함
```

## 4.5 회귀방정식 해석
### 예측변수 간 상관
- 상호 연관된 예측변수들을 사용하면 회귀계수를 해석하기 어려울 수 있음

### 다중공선성
- 변수 상관이 극단적인 경우 나타남
- 한 변수가 여러 번 포함/요인변수로부터 P-1개가 아닌 P개의 가변수가 생성/두 변수가 서로 거의 완벽하게 상관
    - *왜 P-1이 되어야 하는가?*
    : P개의 범주라고 P개의 더미를 만들면 세 변수의 합이 항상 1이 되어 서로 선형결합이 가능해짐

### 교란변수
- 회귀방정식에 중요한 변수가 포함되지 않아서 생기는 누락

## 4.6 회귀진단
> 잔차 분석을 통해 모델이 데이터에 얼마나 적합한지 평가
1. 표준화잔차
    - 잔차/표준오차로 계산
    - 이 값을 조사해서 특잇값 발견
2. 주영향관측값
    - 회귀모형에서 제외됐을때 모델에 중요한 변화를 가져오는 값
3. 레버리지
    - 회귀식에 한 레코드가 미치는 영향력의 정도
    - 햇 값
    - 쿡의 거리 
        - 레버리지와 잔차의 크기를 합쳐서 판단

💡오차가 정규분포를 따른다=모델이 완전하다
```
형식적 추론(객관적이고 수학적인 추론) 이 완전히 유효하려면 잔차는
1. 동일한 분산->regplot
2. 정규분포
3. 서로 독립
```

- 편잔차그림
    - 예측 모델이 예측변수와 결과변수 간 관계를 얼마나 잘 설명하는지 시각화
    - 하나의 예측변수와 응답변수 사이의 관계를 모든 다른 예측변수로부터 분리

## 4.7 다항회귀와 스플라인 회귀
> 응답변수와 예측변수가 반드시 선형일 필요는 없음! 비선형효과를 회귀분석
> 여전히 선형회귀모델로 분류(계수에 대해 선형이기 때문)
![study_3](/stats_study/4.7.png)

⚠️ 다항회귀는 비선형 관계에 대해 어느 정도 곡률을 담아냄...?->선형회귀모델이지만 비선형도 담을 수 있다는 건가

- 스플라인
    - 점들 사이를 부드럽게 보간
- 일반확법모형
    - 스플라인 회귀를 자동으로 찾는 데 사용하는 유동적 모델링 기술
